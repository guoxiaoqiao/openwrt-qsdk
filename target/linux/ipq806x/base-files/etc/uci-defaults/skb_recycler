#!/bin/sh
#
# Copyright (c) 2015 The Linux Foundation. All rights reserved.
#

[ -e /etc/config/skb_recycler ] && exit 0

touch /etc/config/skb_recycler

. /lib/functions/uci-defaults.sh
. /lib/ipq806x.sh

ucidef_set_skb_recycler

board=$(ipq806x_board_name)
max_skbs=1024
memtotal=$(grep MemTotal /proc/meminfo | awk '{print $2}')
[ memtotal -lt 131072 ] && max_skbs=512

case "$board" in
*)
	ucidef_set_skb "max_skbs" $max_skbs
	ucidef_set_skb "max_spare_skbs" "256"
	;;
esac

uci commit skb_recycler

exit 0
